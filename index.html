
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Realidade Aumentada com Modelo Blender</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/2.0.8/aframe/build/aframe-ar.js"></script>
</head>
<body>
    <!-- renderer="logarithmicDepthBuffer: true;" -->
    <a-scene arjs
    embedded
    vr-mode-ui="enabled: false"
    gesture-detector
    id="scene">
    <!-- animation__spin="property: rotation; to: 0 360 0; loop: true; dur: 10000" -->
        <a-marker preset="hiro">
            <!-- Carregue o modelo Blender usando o atributo gltf-model -->
            <a-entity id="model" 
            gltf-model="url(FPFmdel.glb)" 
            scale="0.5 0.5 0.5"
            rotation="0 0 0"
            sliding-control>
      <!-- Adicione um objeto de colisão para capturar cliques -->
      <!-- <a-box position="0 0 0" depth="0.2" height="0.2" width="0.2" material="opacity: 0;"></a-box> -->
        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        alert('Atualizado 1');

        var isTouching = false;
        var initialTouchDistance = 0;

        // Adicione eventos de toque
        document.addEventListener('touchstart', function(event) {
            if (event.touches.length === 2) {
                isTouching = true;
                initialTouchDistance = Math.hypot(
                    event.touches[0].clientX - event.touches[1].clientX,
                    event.touches[0].clientY - event.touches[1].clientY
                );
            }
        });

        document.addEventListener('touchmove', function(event) {
            if (isTouching && event.touches.length === 2) {
                var currentTouchDistance = Math.hypot(
                    event.touches[0].clientX - event.touches[1].clientX,
                    event.touches[0].clientY - event.touches[1].clientY
                );

                var zoomAmount = currentTouchDistance - initialTouchDistance;

                var camera = document.querySelector('a-entity[camera]');
                var currentPosition = camera.getAttribute('position');
                currentPosition.z -= zoomAmount / 100; // Ajuste a sensibilidade do zoom aqui
                camera.setAttribute('position', currentPosition);

                initialTouchDistance = currentTouchDistance;
            }
        });

        document.addEventListener('touchend', function(event) {
            isTouching = false;
        });


        // Evento que pega gesto de rotação
        AFRAME.registerComponent('sliding-control', {
            init: function () {
                this.touchStartX = 0;
                this.el.addEventListener('touchstart', this.onTouchStart.bind(this));
                this.el.addEventListener('touchmove', this.onTouchMove.bind(this));
            },
            onTouchStart: function (event) {
                this.touchStartX = event.touches[0].clientX;
            },
            onTouchMove: function (event) {
                var touchX = event.touches[0].clientX;
                var deltaX = touchX - this.touchStartX;

                // Defina o fator de escala para controlar a sensibilidade do movimento
                var scaleFactor = 0.01;

                // Atualize a posição do modelo no eixo X com base no movimento do dedo
                var car = document.getElementById('car');
                var currentPosition = car.getAttribute('position');
                currentPosition.x += deltaX * scaleFactor;
                car.setAttribute('position', currentPosition);

                this.touchStartX = touchX; // Atualize a posição inicial do toque
            }
        });

    </script>
</body>
</html>